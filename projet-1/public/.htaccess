# Router les requêtes /api/* vers le dossier api/
RewriteEngine On

# Rediriger /api/* vers le dossier api/
RewriteCond %{REQUEST_URI} ^/api/(.*)$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api/(.*)$ api/index.php [L,QSA]

# Gestion des erreurs 404 pour le frontend React
ErrorDocument 404 /index.html

# Headers CORS pour l'API
<IfModule mod_headers.c>
    <LocationMatch "^/api/">
        Header always set Access-Control-Allow-Origin "*"
        Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
        
        # Gérer les requêtes preflight OPTIONS
        RewriteEngine On
        RewriteCond %{REQUEST_METHOD} OPTIONS
        RewriteRule ^(.*)$ $1 [R=200,L]
    </LocationMatch>
</IfModule>
